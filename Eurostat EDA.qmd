---
title: "Eurostat EDA"
author: "Sindre H. Øveraas, Alen Colacovic & Sebastian M. Fløysand"
format: pdf
editor: visual
---

## Eurostat EDA

### Sub-National GDP

Country codes: BE - Belgium, BG - Bulgaria, HR - Croatia, IT - Italy, AT - Austria, SE - Sweden, RS - Serbia

```{r, message=FALSE}
library(tidyverse)
library(vtable)
library(dineq)
library(dplyr)
```

```{r}
library(readr)
GDP <- read.csv('nama_10r_3gdp__custom_3564935_linear.csv')
Population <- read_csv("demo_r_pjanaggr3__custom_3579517_linear.csv")

gdpdata <- GDP %>%
  rename(Year = TIME_PERIOD, GDP = OBS_VALUE, Region = geo)

populationdata <- Population %>%
  rename(Year = TIME_PERIOD, Population = OBS_VALUE, Region = geo)

GDP_Per_Capita <- gdpdata %>%
  left_join(populationdata, by=c("Region", "Year")) %>%
  select(Region, Year, GDP, Population) %>%
  mutate(
    GDP_capita = (GDP * 1000000)/Population
  )
```

```{r, echo=FALSE}
summary(GDP_Per_Capita[,3:5])
```

Looking at the GDP per capita for all country´s in the dataset, we find that the difference in population from min to max is big.
The difference between Median and Mean is also relatively big witch can indicate that some of the biggest regions has much larger amount of population then the rest and therefore affects the mean and pulls it higher.
The fact that the 3rd quartile is just a few thousands away from the mean amplifies our suspicion that we have some outliers with a very high population compared to the rest.

Its reason to believe that high population equals high GDP based on the fact that it is more people that contributes to the GDP.
However, this can not be applied in every circumstances.
For example Monaco with a population in 2020 of just above 39.000 [@MonacoPopulation2022] had a GDP on 6.25 billion USD the same year versus Burundi with a GDP on 3.22 billion [@GDPConstant2015] and a population just above 11.89 million [@BurundiPopulation2022].
The GDP per capita gives us a more accurate measure.
in the model above we can see that its a big difference in GDP per capita in each region, this can be caused by a population or a cluster with rich/poor individuals.

We also had some NA values witch we chose to take out of the dataset.
NA values may come from the fact that Population or the GDP was not measured this year or was not available when the dataset was made.

```{r}
GDP_Per_Capita$GDP_capita <- as.numeric(GDP_Per_Capita$GDP_capita)
GDP_Per_Capita$Population <- as.numeric(GDP_Per_Capita$Population)
```

```{r}
gini.wtd(GDP_Per_Capita$GDP_capita, weights = GDP_Per_Capita$Population)
```

```{r}
GDP_Per_Capita <- GDP_Per_Capita %>%  
  mutate(NUTS2 = substr(GDP_Per_Capita$Region,1,4))

GDP_Per_Capita <- GDP_Per_Capita %>%  
  mutate(NUTS = substr(GDP_Per_Capita$Region,1,2))

GDP_Per_Capita  %<>%
  group_by(NUTS2) %>%
  na.exclude(GDP_Per_Capita) %>%
  mutate(GINI_NUTS2 = gini.wtd(GDP_capita, weights = Population)) %>%
  ungroup()
```

```{r}
summary(GDP_Per_Capita[8])
```

```{r, echo=FALSE}
ggplot(data = GDP_Per_Capita) + geom_density(aes(x = GINI_NUTS2), fill = "maroon", col = "maroon", alpha = 0.2) + theme_bw()
```

```{r, echo=FALSE}
ggplot(data = GDP_Per_Capita) + geom_histogram(aes(x = GINI_NUTS2), fill = "maroon", col = "maroon", alpha = 0.2) + theme_bw()
```

Looking at the plot above there is one outlier up against 0.4 with around 100 observations.
The same result also seem to accure in the density plot.
